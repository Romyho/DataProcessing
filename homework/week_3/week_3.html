<!DOCTYPE html

<html>
<head>
<title></title>
</head>
<body>

<h1> Romy Ho(11007303) </h1>
<canvas id="canvas" width="300" height="300"></canvas>
<script>
var fileName = "MEI_SPAIN_89-17.json";
var txtFile = new XMLHttpRequest();
txtFile.onreadystatechange = function() {
    if (txtFile.readyState === 4 && txtFile.status == 200) {
        var data = JSON.parse(txtFile.responseText);
        var count = Object.keys(data).length;
        var max_value = 0;
        var min_value = 0;
        for(var i in data){
            if(data[i].Value > max_value){
            max_value = data[i].Value
            }
            if(data[i].Value < min_value){
              min_value = data[i].Value
            }
        }
        dom_value = [min_value, max_value];
        // console.log(dom_value)
        max_length = data.length
        min_datum = data[0].TIME
        max_datum = data[(max_length-1)].TIME
        dom_datum = [min_datum, max_datum];
        // console.log(dom_datum)

        createT_y = createTransform(dom_value, range_y);
        createT_x = createTransform(dom_datum, range_x);
        // console.log(data.length)
        var punt_1 = [createT_x(min_datum), createT_y(min_value)];
        var punt_2 = [createT_x(max_datum), createT_y(max_value)];
        // console.log(punt_1)
        // console.log(punt_2)

        // ctx.moveTo(createT_x(min_datum), createT_y(min_value));
        // ctx.lineTo(createT_x(max_datum), createT_y(max_value));

        for (var i = 0; i<(data.length-1); i++) {
          // console.log("van")
          // console.log(createT_x(data[i].TIME), createT_y(data[i].Value))
          ctx.moveTo(createT_x(data[i].TIME), createT_y(data[i].Value));
          // ctx.scale(-1,1);
          // console.log("naar")
          // console.log(createT_x(data[(i+1)].TIME), createT_y(data[(i+1)].Value))
          ctx.lineTo(createT_x(data[(i+1)].TIME), createT_y(data[(i+1)].Value));

          ctx.stroke();
          }

      }
    }
    range_x = [0, 300]
    range_y = [0, 100]





function createTransform(domain, range){
	// domain is a two-element array of the data bounds [domain_min, domain_max]
	// range is a two-element array of the screen bounds [range_min, range_max]
	// this gives you two equations to solve:
	// range_min = alpha * domain_min + beta
	// range_max = alpha * domain_max + beta
 		// a solution would be:

    var domain_min = domain[0]
    var domain_max = domain[1]
    var range_min = range[0]
    var range_max = range[1]

    // formulas to calculate the alpha and the beta
   	var alpha = (range_max - range_min) / (domain_max - domain_min)
    var beta = range_max - alpha * domain_max

    // returns the function for the linear transformation (y= a * x + b)
    return function(x){
      return alpha * x + beta;
    }
}

// createTransform(dom_value,)
var canvas = document.getElementById('canvas');
var ctx = canvas.getContext('2d');
ctx.strokeStyle = 'blue';
ctx.strokeRect(0, 0, 400, 200);

txtFile.open("GET", fileName);
txtFile.send();

</script>

</body>
</html>
